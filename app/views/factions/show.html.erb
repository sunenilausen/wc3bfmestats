<% content_for :title, @faction.name %>

<div class="w-full">
  <% if notice.present? %>
    <p class="py-2 px-3 bg-green-50 mb-5 text-green-500 font-medium rounded-md inline-block" id="notice"><%= notice %></p>
  <% end %>

  <div class="flex items-center justify-between mb-6">
    <div class="flex items-center gap-3">
      <span class="w-5 h-5 rounded-full inline-block" style="background-color: <%= @faction.color_hex %>"></span>
      <h1 class="font-bold text-4xl"><%= @faction.name %></h1>
      <span class="px-2 py-1 rounded text-sm font-medium <%= @faction.good? ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700' %>">
        <%= @faction.good? ? "Good" : "Evil" %>
      </span>
    </div>

    <%= form_with url: faction_path(@faction), method: :get, local: true, class: "flex flex-wrap items-center gap-4" do %>
      <div class="flex items-center gap-2">
        <label for="version_filter" class="text-sm text-gray-600">Stats:</label>
        <select name="version_filter" id="version_filter" onchange="this.form.submit()" class="rounded-md border border-gray-300 px-3 py-1.5 text-sm">
          <option value="">All versions</option>
          <option value="last:100" <%= "selected" if @version_filter == "last:100" %>>Last 100 games</option>
          <option value="last:50" <%= "selected" if @version_filter == "last:50" %>>Last 50 games</option>
          <% @available_map_versions.each do |version| %>
            <option value="from:<%= version %>" <%= "selected" if @version_filter == "from:#{version}" %>>from <%= version %></option>
          <% end %>
          <optgroup label="Single version">
            <% @available_map_versions.each do |version| %>
              <option value="only:<%= version %>" <%= "selected" if @version_filter == "only:#{version}" %>>only <%= version %></option>
            <% end %>
          </optgroup>
        </select>
      </div>
    <% end %>
  </div>

  <% if @last_n_games.present? && @last_n_games > 0 %>
    <div class="mb-4 px-3 py-2 bg-blue-50 border border-blue-200 rounded-md text-sm text-blue-700">
      Showing stats for <strong>last <%= @last_n_games %> games</strong> (<%= @stats[:total_games] %> games)
      &mdash; <%= link_to "Show all games", faction_path(@faction), class: "underline hover:no-underline" %>
    </div>
  <% elsif @map_version.present? %>
    <div class="mb-4 px-3 py-2 bg-blue-50 border border-blue-200 rounded-md text-sm text-blue-700">
      Showing stats for <strong><%= @map_version %></strong> only (<%= @stats[:total_games] %> games)
      &mdash; <%= link_to "Show all versions", faction_path(@faction), class: "underline hover:no-underline" %>
    </div>
  <% elsif @map_version_until.present? %>
    <div class="mb-4 px-3 py-2 bg-blue-50 border border-blue-200 rounded-md text-sm text-blue-700">
      Showing stats from <strong><%= @map_version_until %></strong> onwards (<%= @stats[:total_games] %> games across <%= @filtered_map_versions.size %> versions)
      &mdash; <%= link_to "Show all versions", faction_path(@faction), class: "underline hover:no-underline" %>
    </div>
  <% end %>

  <%# Stats Cards %>
  <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
    <div class="bg-gray-50 rounded-md p-3">
      <h3 class="font-semibold mb-2 text-gray-700">Kill Averages</h3>
      <table class="w-full text-sm">
        <tbody>
          <tr>
            <td class="py-0.5">Hero Kills/game</td>
            <td class="text-right py-0.5"><%= @stats[:avg_hero_kills] %></td>
          </tr>
          <tr>
            <td class="py-0.5">Hero Kills/min</td>
            <td class="text-right py-0.5"><%= @stats[:avg_hero_kills_per_min] %></td>
          </tr>
          <tr>
            <td class="py-0.5">Unit Kills/game</td>
            <td class="text-right py-0.5"><%= @stats[:avg_unit_kills] %></td>
          </tr>
          <tr>
            <td class="py-0.5">Unit Kills/min</td>
            <td class="text-right py-0.5"><%= @stats[:avg_unit_kills_per_min] %></td>
          </tr>
          <tr>
            <td class="py-0.5">Castles Razed/game</td>
            <td class="text-right py-0.5"><%= @stats[:avg_castles_razed] %></td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="bg-gray-50 rounded-md p-3">
      <h3 class="font-semibold mb-2 text-gray-700">Team Contribution</h3>
      <table class="w-full text-sm">
        <tbody>
          <tr>
            <td class="py-0.5">Avg Hero Kill Share</td>
            <td class="text-right py-0.5"><%= @stats[:avg_hero_kill_contribution] %>%</td>
          </tr>
          <tr>
            <td class="py-0.5">Top Hero Killer</td>
            <td class="text-right py-0.5"><%= number_with_precision(@stats[:times_top_hero_kills], precision: 1) %>x (<%= @stats[:top_hero_kills_pct] %>%)</td>
          </tr>
          <tr>
            <td class="py-0.5">Avg Unit Kill Share</td>
            <td class="text-right py-0.5"><%= @stats[:avg_unit_kill_contribution] %>%</td>
          </tr>
          <tr>
            <td class="py-0.5">Top Unit Killer</td>
            <td class="text-right py-0.5"><%= number_with_precision(@stats[:times_top_unit_kills], precision: 1) %>x (<%= @stats[:top_unit_kills_pct] %>%)</td>
          </tr>
          <tr>
            <% mvp_tooltip = "Top hero kills AND top unit kills on winning team" %>
            <% if ["Minas Morgul", "Fellowship"].include?(@faction.name) %>
              <% mvp_tooltip += " (unit kills × 1.5 for this faction)" %>
            <% end %>
            <td class="py-0.5" title="<%= mvp_tooltip %>"><span class="text-yellow-500">★</span> MVP</td>
            <td class="text-right py-0.5"><%= @stats[:times_mvp] %>x</td>
          </tr>
          <tr>
            <td class="py-0.5">Avg Castle Raze Share</td>
            <td class="text-right py-0.5"><%= @stats[:avg_castle_raze_contribution] %>%</td>
          </tr>
          <tr>
            <td class="py-0.5" title="Average share of team's total healing">Avg Heal Share</td>
            <td class="text-right py-0.5"><%= @stats[:avg_heal_contribution] %>%</td>
          </tr>
          <tr>
            <td class="py-0.5" title="Average share of team's healing applied to teammates">Avg Team Heal Share</td>
            <td class="text-right py-0.5"><%= @stats[:avg_team_heal_contribution] %>%</td>
          </tr>
          <tr>
            <td class="py-0.5" title="Average contribution rank within team (1 = top performer, 5 = lowest)">Avg Contribution Rank</td>
            <td class="text-right py-0.5">
              <% rank = @stats[:avg_contribution_rank] %>
              <% if rank && rank > 0 %>
                <span class="<%= rank <= 2 ? 'text-green-600' : (rank >= 4 ? 'text-red-600' : '') %>">
                  #<%= rank %>
                </span>
              <% else %>
                -
              <% end %>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="bg-gray-50 rounded-md p-3">
      <h3 class="font-semibold mb-2 text-gray-700">Overview</h3>
      <table class="w-full text-sm">
        <tbody>
          <tr>
            <td class="py-0.5">Unique Players</td>
            <td class="text-right py-0.5"><%= @stats[:unique_players] %></td>
          </tr>
          <tr>
            <td class="py-0.5">Hero K/D Ratio</td>
            <td class="text-right py-0.5">
              <% if @hero_kd_ratio %>
                <%= @hero_kills %>/<%= @hero_deaths %>
                <span class="text-gray-500">(<%= @hero_kd_ratio %>)</span>
              <% else %>
                <%= @hero_kills %>/0
              <% end %>
            </td>
          </tr>
          <tr>
            <td class="py-0.5">Hero Uptime</td>
            <td class="text-right py-0.5"><%= @hero_uptime %>%</td>
          </tr>
          <% if @faction.bases.any? %>
            <tr>
              <td class="py-0.5">Base Uptime</td>
              <td class="text-right py-0.5"><%= @base_uptime %>%</td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>

  <%# Leaderboards %>
  <h2 class="text-xl font-bold mb-3">Leaderboards</h2>
  <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
    <%# Highest Win Rate %>
    <div class="bg-gray-50 rounded-md p-3">
      <h3 class="font-semibold mb-2 text-gray-700">Highest Win Rate <span class="text-xs text-gray-400">(min 10 games)</span></h3>
      <% if @stats[:top_winrate_players].any? %>
        <table class="w-full text-sm">
          <tbody>
            <% @stats[:top_winrate_players].each_with_index do |data, i| %>
              <tr class="<%= i < @stats[:top_winrate_players].size - 1 ? 'border-b border-gray-100' : '' %>">
                <td class="py-1"><%= i + 1 %>. <%= link_to data[:player].nickname, player_path(data[:player]), class: "text-blue-600 hover:underline" %></td>
                <td class="text-right py-1">
                  <span class="text-green-600 font-medium"><%= data[:winrate] %>%</span>
                  <span class="text-gray-400 text-xs">(<%= data[:wins] %>W/<%= data[:games] %>G)</span>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
      <% else %>
        <p class="text-gray-400 text-sm">No players with 10+ games yet.</p>
      <% end %>
    </div>

    <%# Most Wins %>
    <div class="bg-gray-50 rounded-md p-3">
      <h3 class="font-semibold mb-2 text-gray-700">Most Wins</h3>
      <% if @stats[:most_wins_players].any? %>
        <table class="w-full text-sm">
          <tbody>
            <% @stats[:most_wins_players].each_with_index do |data, i| %>
              <tr class="<%= i < @stats[:most_wins_players].size - 1 ? 'border-b border-gray-100' : '' %>">
                <td class="py-1"><%= i + 1 %>. <%= link_to data[:player].nickname, player_path(data[:player]), class: "text-blue-600 hover:underline" %></td>
                <td class="text-right py-1">
                  <span class="text-green-600 font-medium"><%= data[:wins] %></span>
                  <span class="text-gray-400 text-xs">(<%= data[:games] %> games)</span>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
      <% else %>
        <p class="text-gray-400 text-sm">No players found.</p>
      <% end %>
    </div>

    <%# Top Hero Killers %>
    <div class="bg-gray-50 rounded-md p-3">
      <h3 class="font-semibold mb-2 text-gray-700">Top Hero Killers <span class="text-xs text-gray-400">(min 5 games)</span></h3>
      <% if @stats[:top_hero_killers].any? %>
        <table class="w-full text-sm">
          <tbody>
            <% @stats[:top_hero_killers].each_with_index do |data, i| %>
              <tr class="<%= i < @stats[:top_hero_killers].size - 1 ? 'border-b border-gray-100' : '' %>">
                <td class="py-1"><%= i + 1 %>. <%= link_to data[:player].nickname, player_path(data[:player]), class: "text-blue-600 hover:underline" %></td>
                <td class="text-right py-1">
                  <span class="font-medium"><%= data[:top_pct] %>%</span>
                  <span class="text-gray-400 text-xs">(<%= number_with_precision(data[:top_hero], precision: 1) %>/<%= data[:games] %>)</span>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
      <% else %>
        <p class="text-gray-400 text-sm">No players with 5+ games yet.</p>
      <% end %>
    </div>

    <%# Top Unit Killers %>
    <div class="bg-gray-50 rounded-md p-3">
      <h3 class="font-semibold mb-2 text-gray-700">Top Unit Killers <span class="text-xs text-gray-400">(min 5 games)</span></h3>
      <% if @stats[:top_unit_killers].any? %>
        <table class="w-full text-sm">
          <tbody>
            <% @stats[:top_unit_killers].each_with_index do |data, i| %>
              <tr class="<%= i < @stats[:top_unit_killers].size - 1 ? 'border-b border-gray-100' : '' %>">
                <td class="py-1"><%= i + 1 %>. <%= link_to data[:player].nickname, player_path(data[:player]), class: "text-blue-600 hover:underline" %></td>
                <td class="text-right py-1">
                  <span class="font-medium"><%= data[:top_pct] %>%</span>
                  <span class="text-gray-400 text-xs">(<%= number_with_precision(data[:top_unit], precision: 1) %>/<%= data[:games] %>)</span>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
      <% else %>
        <p class="text-gray-400 text-sm">No players with 5+ games yet.</p>
      <% end %>
    </div>

    <%# Top Faction Performance %>
    <div class="bg-gray-50 rounded-md p-3">
      <h3 class="font-semibold mb-2 text-gray-700">Top Faction Performance <span class="text-xs text-gray-400">(min 10 games)</span></h3>
      <% if @top_performers.any? %>
        <table class="w-full text-sm">
          <tbody>
            <% @top_performers.each_with_index do |pfs, i| %>
              <tr class="<%= pfs != @top_performers.last ? 'border-b border-gray-100' : '' %>">
                <td class="py-1">
                  <span class="<%= i < 3 ? 'text-yellow-600 font-semibold' : '' %>"><%= i + 1 %>.</span>
                  <%= link_to pfs.player.nickname, player_path(pfs.player), class: "text-blue-600 hover:underline" %>
                </td>
                <td class="text-right py-1">
                  <span class="<%= ml_score_color_class(pfs.faction_score) %> font-medium"><%= pfs.faction_score ? format_perf_score(pfs.faction_score.round(1)) : "-" %></span>
                  <span class="text-gray-400 text-xs">(<%= pfs.games_played %> games)</span>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
      <% else %>
        <p class="text-gray-400 text-sm">No players with 10+ games yet.</p>
      <% end %>
    </div>

    <%# Best Average Rank %>
    <div class="bg-gray-50 rounded-md p-3">
      <h3 class="font-semibold mb-2 text-gray-700">Best Average Rank <span class="text-xs text-gray-400">(min 10 games)</span></h3>
      <% if @top_rank_players.any? %>
        <table class="w-full text-sm">
          <tbody>
            <% @top_rank_players.each_with_index do |data, i| %>
              <tr class="<%= i < @top_rank_players.size - 1 ? 'border-b border-gray-100' : '' %>">
                <td class="py-1">
                  <span class="<%= i < 3 ? 'text-yellow-600 font-semibold' : '' %>"><%= i + 1 %>.</span>
                  <%= link_to data[:player].nickname, player_path(data[:player]), class: "text-blue-600 hover:underline" %>
                </td>
                <td class="text-right py-1">
                  <span class="<%= data[:avg_rank] <= 2 ? 'text-green-600' : (data[:avg_rank] >= 4 ? 'text-red-600' : '') %> font-medium">#<%= data[:avg_rank] %></span>
                  <span class="text-gray-400 text-xs">(<%= data[:games] %> games)</span>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
      <% else %>
        <p class="text-gray-400 text-sm">No players with 10+ games yet.</p>
      <% end %>
    </div>
  </div>

  <%# Base Statistics %>
  <% if @base_stats.any? %>
    <h2 class="text-xl font-bold mb-3">Base Statistics</h2>
    <div class="bg-gray-50 rounded-md p-3 mb-6">
      <table class="w-full text-sm">
        <thead>
          <tr class="border-b border-gray-200">
            <th class="text-left py-2 font-semibold text-gray-700">Base</th>
            <th class="text-right py-2 font-semibold text-gray-700">Death Rate</th>
            <th class="text-right py-2 font-semibold text-gray-700">Avg Time to Death</th>
          </tr>
        </thead>
        <tbody>
          <% @base_stats.each do |base| %>
            <tr class="border-b border-gray-100 last:border-b-0">
              <td class="py-2"><%= base[:name] %></td>
              <td class="text-right py-2">
                <span class="<%= base[:death_rate] <= 50 ? 'text-green-600' : 'text-red-600' %> font-medium">
                  <%= base[:death_rate] %>%
                </span>
                <span class="text-gray-400 text-xs">(<%= base[:deaths] %>)</span>
              </td>
              <td class="text-right py-2 text-gray-600">
                <% if base[:avg_time_to_death] %>
                  <%= ChronicDuration.output(base[:avg_time_to_death], format: :short) %>
                <% else %>
                  -
                <% end %>
              </td>
            </tr>
          <% end %>
          <% if @base_loss_stats.present? %>
            <tr class="border-t-2 border-gray-200 font-medium">
              <td class="py-2">All bases lost</td>
              <td class="text-right py-2">
                <span class="<%= @base_loss_stats[:all_bases_lost_rate] <= 50 ? 'text-green-600' : 'text-red-600' %> font-medium">
                  <%= @base_loss_stats[:all_bases_lost_rate] %>%
                </span>
                <span class="text-gray-400 text-xs">(<%= @base_loss_stats[:all_bases_lost] %>)</span>
              </td>
              <td class="text-right py-2 text-gray-600">
                <% if @base_loss_stats[:avg_time_to_lose_all] %>
                  <%= ChronicDuration.output(@base_loss_stats[:avg_time_to_lose_all], format: :short) %>
                <% else %>
                  -
                <% end %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  <% end %>

  <%# Hero Statistics %>
  <% if @hero_stats.any? %>
    <% has_second_death = @hero_stats.any? { |h| h[:second_death_rate].present? } %>
    <h2 class="text-xl font-bold mb-3">Hero Statistics</h2>
    <div class="bg-gray-50 rounded-md p-3 mb-6">
      <table class="w-full text-sm">
        <thead>
          <tr class="border-b border-gray-200">
            <th class="text-left py-2 font-semibold text-gray-700">Hero</th>
            <th class="text-right py-2 font-semibold text-gray-700">Death Rate</th>
            <th class="text-right py-2 font-semibold text-gray-700">Avg Time to Death</th>
            <% if has_second_death %>
              <th class="text-right py-2 font-semibold text-gray-700">2nd Death Rate</th>
              <th class="text-right py-2 font-semibold text-gray-700">Avg Time to 2nd Death</th>
            <% end %>
          </tr>
        </thead>
        <tbody>
          <% @hero_stats.each do |hero| %>
            <tr class="border-b border-gray-100 last:border-b-0">
              <td class="py-2">
                <%= hero[:name] %>
                <% if hero[:bonus] %>
                  <span class="text-gray-400 text-xs">(bonus)</span>
                <% end %>
              </td>
              <td class="text-right py-2">
                <span class="<%= hero[:death_rate] <= 50 ? 'text-green-600' : 'text-red-600' %> font-medium">
                  <%= hero[:death_rate] %>%
                </span>
                <span class="text-gray-400 text-xs">(<%= hero[:deaths] %><% if hero[:extra_deaths] > 0 %>+<%= hero[:extra_deaths] %><% end %>)</span>
              </td>
              <td class="text-right py-2 text-gray-600">
                <% if hero[:avg_time_to_death] %>
                  <%= ChronicDuration.output(hero[:avg_time_to_death], format: :short) %>
                <% else %>
                  -
                <% end %>
              </td>
              <% if has_second_death %>
                <td class="text-right py-2">
                  <% if hero[:second_death_rate].present? %>
                    <span class="<%= hero[:second_death_rate] <= 50 ? 'text-green-600' : 'text-red-600' %> font-medium">
                      <%= hero[:second_death_rate] %>%
                    </span>
                    <span class="text-gray-400 text-xs">(<%= hero[:second_deaths] %>)</span>
                  <% else %>
                    -
                  <% end %>
                </td>
                <td class="text-right py-2 text-gray-600">
                  <% if hero[:avg_time_to_second_death] %>
                    <%= ChronicDuration.output(hero[:avg_time_to_second_death], format: :short) %>
                  <% else %>
                    -
                  <% end %>
                </td>
              <% end %>
            </tr>
          <% end %>
          <% if @hero_loss_stats.present? %>
            <tr class="border-t-2 border-gray-200 font-medium">
              <td class="py-2">All starting heroes lost</td>
              <td class="text-right py-2">
                <span class="<%= @hero_loss_stats[:all_heroes_lost_rate] <= 50 ? 'text-green-600' : 'text-red-600' %> font-medium">
                  <%= @hero_loss_stats[:all_heroes_lost_rate] %>%
                </span>
                <span class="text-gray-400 text-xs">(<%= @hero_loss_stats[:all_heroes_lost] %>)</span>
              </td>
              <td class="text-right py-2 text-gray-600">
                <% if @hero_loss_stats[:avg_time_to_lose_all] %>
                  <%= ChronicDuration.output(@hero_loss_stats[:avg_time_to_lose_all], format: :short) %>
                <% else %>
                  -
                <% end %>
              </td>
              <% if has_second_death %>
                <% if @hero_loss_stats[:all_heroes_lost_twice_rate].present? %>
                  <td class="text-right py-2">
                    <span class="<%= @hero_loss_stats[:all_heroes_lost_twice_rate] <= 50 ? 'text-green-600' : 'text-red-600' %> font-medium">
                      <%= @hero_loss_stats[:all_heroes_lost_twice_rate] %>%
                    </span>
                    <span class="text-gray-400 text-xs">(<%= @hero_loss_stats[:all_heroes_lost_twice] %>)</span>
                  </td>
                  <td class="text-right py-2 text-gray-600">
                    <% if @hero_loss_stats[:avg_time_to_lose_all_twice] %>
                      <%= ChronicDuration.output(@hero_loss_stats[:avg_time_to_lose_all_twice], format: :short) %>
                    <% else %>
                      -
                    <% end %>
                  </td>
                <% else %>
                  <td></td>
                  <td></td>
                <% end %>
              <% end %>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  <% end %>

  <%# Ring Event Statistics %>
  <% if @ring_event_stats.present? %>
    <h2 class="text-xl font-bold mb-3">Ring Events</h2>
    <div class="bg-gray-50 rounded-md p-3 mb-6">
      <table class="w-full text-sm">
        <thead>
          <tr class="border-b border-gray-200">
            <th class="text-left py-2 font-semibold text-gray-700">Event</th>
            <th class="text-right py-2 font-semibold text-gray-700">Occurrence Rate</th>
            <th class="text-right py-2 font-semibold text-gray-700">Avg Time</th>
          </tr>
        </thead>
        <tbody>
          <tr class="<%= @ring_event_stats[:sauron_death_rate] ? 'border-b border-gray-100' : '' %>">
            <td class="py-2"><%= @ring_event_stats[:name] %></td>
            <td class="text-right py-2">
              <span class="<%= @faction.good? ? (@ring_event_stats[:occurrence_rate] <= 50 ? 'text-green-600' : 'text-red-600') : (@ring_event_stats[:occurrence_rate] >= 50 ? 'text-green-600' : 'text-red-600') %> font-medium">
                <%= @ring_event_stats[:occurrence_rate] %>%
              </span>
              <span class="text-gray-400 text-xs">(<%= @ring_event_stats[:occurrences] %>)</span>
            </td>
            <td class="text-right py-2 text-gray-600">
              <% if @ring_event_stats[:avg_time] %>
                <%= ChronicDuration.output(@ring_event_stats[:avg_time], format: :short) %>
              <% else %>
                -
              <% end %>
            </td>
          </tr>
          <% if @ring_event_stats[:sauron_death_rate] %>
            <tr>
              <td class="py-2 pl-4 text-gray-600">↳ Sauron dies after</td>
              <td class="text-right py-2">
                <span class="<%= @ring_event_stats[:sauron_death_rate] <= 50 ? 'text-green-600' : 'text-red-600' %> font-medium">
                  <%= @ring_event_stats[:sauron_death_rate] %>%
                </span>
                <span class="text-gray-400 text-xs">(<%= @ring_event_stats[:sauron_deaths] %>)</span>
              </td>
              <td class="text-right py-2 text-gray-600">
                <% if @ring_event_stats[:sauron_avg_time_to_death] %>
                  <%= ChronicDuration.output(@ring_event_stats[:sauron_avg_time_to_death], format: :short) %>
                <% else %>
                  -
                <% end %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  <% end %>

  <div class="flex gap-2">
    <% if can? :update, @faction %>
      <%= link_to "Edit", edit_faction_path(@faction), class: "rounded-md px-3 py-2 bg-gray-100 hover:bg-gray-50 text-sm font-medium" %>
    <% end %>
    <%= link_to "Back", factions_path, class: "rounded-md px-3 py-2 bg-gray-100 hover:bg-gray-50 text-sm font-medium" %>
  </div>
</div>
