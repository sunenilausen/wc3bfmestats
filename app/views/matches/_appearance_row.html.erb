<tr>
  <td class="px-2 py-1 font-medium">
    <% if appearance.faction %>
      <span style="display: inline-block; width: 14px; height: 14px; background-color: <%= appearance.faction.color %>; border-radius: 3px; margin-right: 6px; vertical-align: middle;"></span>
    <% end %>
    <% if appearance.player %>
      <%= link_to appearance.player.nickname, player_path(appearance.player) %>
    <% else %>
      <span class="text-gray-400">Unknown</span>
    <% end %>
  </td>
  <td class="px-2 py-1">
    <%= previous_record_for_appearance(appearance) %>
  </td>
  <td class="px-2 py-1">
    <%= appearance.unit_kills %>
  </td>
  <td class="px-2 py-1">
    <%= appearance.hero_kills %>
  </td>
  <td class="px-2 py-1">
    <%= appearance.castles_razed || "-" %>
  </td>
  <td class="px-2 py-1">
    <%= heroes_lost_for_appearance(appearance) || "-" %>
  </td>
  <td class="px-2 py-1">
    <% uptime = calculate_hero_uptime_for_appearance(appearance, appearance.match) %>
    <% if uptime %>
      <span class="<%= uptime >= 80 ? 'text-green-600' : (uptime >= 60 ? 'text-yellow-600' : 'text-red-600') %>">
        <%= uptime %>%
      </span>
    <% else %>
      -
    <% end %>
  </td>
  <td class="px-2 py-1">
    <%= bases_lost_for_appearance(appearance) || "-" %>
  </td>
  <td class="px-2 py-1">
    <%= appearance.self_heal || "-" %>
  </td>
  <td class="px-2 py-1">
    <%= appearance.team_heal || "-" %>
  </td>
  <td class="px-2 py-1">
    <%= appearance.total_heal || "-" %>
  </td>
  <td class="px-2 py-1">
    <% contrib = contribution_bonus_for_appearance(appearance, appearances) %>
    <span class="text-gray-500">#<%= contrib[:rank] %></span>
    <span class="<%= contrib[:bonus] > 0 ? 'text-green-600' : (contrib[:bonus] < 0 ? 'text-red-600' : 'text-gray-400') %>">
      <%= contrib[:bonus] >= 0 ? '+' : '' %><%= contrib[:bonus] %>
    </span>
  </td>
  <td class="px-2 py-1">
    <%= appearance.custom_rating&.round %>
  </td>
  <td class="px-2 py-1">
    <% if appearance.custom_rating_change %>
      <span class="<%= appearance.custom_rating_change >= 0 ? 'text-green-600' : 'text-red-600' %>">
        <%= appearance.custom_rating_change >= 0 ? '+' : '' %><%= appearance.custom_rating_change.round %>
      </span>
    <% end %>
  </td>
</tr>
