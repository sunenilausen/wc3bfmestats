<% content_for :title, "Match ##{@match.id} - #{@match.uploaded_at&.strftime('%Y-%m-%d') || 'Unknown date'}" %>

<div class="w-full">
  <% if notice.present? %>
    <p class="py-2 px-3 bg-green-50 mb-5 text-green-500 font-medium rounded-md inline-block" id="notice"><%= notice %></p>
  <% end %>

  <div class="flex justify-between items-center mb-4">
    <% if @previous_match %>
      <%= link_to match_path(@previous_match), class: "rounded-md px-3 py-2 bg-gray-100 hover:bg-gray-200 font-medium" do %>
        &larr; Previous
      <% end %>
    <% else %>
      <span class="rounded-md px-3 py-2 bg-gray-50 text-gray-400 font-medium">&larr; Previous</span>
    <% end %>

    <h1 class="font-bold text-4xl">Match</h1>

    <% if @next_match %>
      <%= link_to match_path(@next_match), class: "rounded-md px-3 py-2 bg-gray-100 hover:bg-gray-200 font-medium" do %>
        Next &rarr;
      <% end %>
    <% else %>
      <span class="rounded-md px-3 py-2 bg-gray-50 text-gray-400 font-medium">Next &rarr;</span>
    <% end %>
  </div>

  <% cache ["match_show", @match.id, @match.updated_at, StatsCacheKey.key] do %>
    <%= render @match %>
  <% end %>

  <% if can? :update, @match %>
    <%= link_to "Edit this match", edit_match_path(@match), class: "w-full sm:w-auto text-center rounded-md px-3.5 py-2.5 bg-gray-100 hover:bg-gray-50 inline-block font-medium" %>
  <% end %>
  <%= link_to "Back to matches", matches_path, class: "w-full sm:w-auto text-center mt-2 sm:mt-0 sm:ml-2 rounded-md px-3.5 py-2.5 bg-gray-100 hover:bg-gray-50 inline-block font-medium" %>
  <% if can? :destroy, @match %>
    <%= button_to "Destroy this match", @match, method: :delete, form_class: "sm:inline-block mt-2 sm:mt-0 sm:ml-2", class: "w-full rounded-md px-3.5 py-2.5 text-white bg-red-600 hover:bg-red-500 font-medium cursor-pointer", data: { turbo_confirm: "Are you sure?" } %>
  <% end %>
  <% if current_user&.admin? && @match.wc3stats_replay.present? %>
    <%= button_to "Refetch from wc3stats", refetch_match_path(@match), method: :post, form_class: "sm:inline-block mt-2 sm:mt-0 sm:ml-2", class: "w-full rounded-md px-3.5 py-2.5 text-white bg-blue-600 hover:bg-blue-500 font-medium cursor-pointer", data: { turbo_confirm: "This will delete and re-import this match from wc3stats. Continue?" } %>
  <% end %>
</div>
